Fix login issues on some devices